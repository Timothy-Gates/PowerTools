<!DOCTYPE html>
<html>
<!-- start right frame -->
<head>
    <title>ADA Troubleshooter</title>
    ~[wc:commonscripts]
    <link href="/images/css/screen.css" rel="stylesheet" media="screen">
    <link href="/images/css/print.css" rel="stylesheet" media="print">
    <script>
        var powerTools = powerTools || {
                    adaTroubleshooter: {
                        studentCompletionCount: 0,
                        dateEntered: '06/09/2016',
                        studentId: '~(id)',
                        studentFrn: '~(frn)',
                        studentInfo: {},
                        fteInfo: {},
                        dateInfo: {},
                        reEnrollInfo: {},
                        currentDate: {day: 0,month: 0, year: 0},
                        daysObjects: [],
                        /* Retrieve Student info */
                        retrieveStudent: function(){
                            $j.getJSON('/admin/tech/PowerTools/json/adaTroubleshooter/studentinfo.json?id=' +
                                    powerTools.adaTroubleshooter.studentId + '&dateEntered=' +
                                    powerTools.adaTroubleshooter.dateEntered, function(result){
                                powerTools.adaTroubleshooter.studentInfo = result;
                            }).done(function(){
                                powerTools.adaTroubleshooter.displayStudent();
                            });
                        },
                        /* Retrieve School info */
                        retrieveFte: function(){
                            $j.getJSON('/admin/tech/PowerTools/json/adaTroubleshooter/fteinfo.json?id=' +
                                    powerTools.adaTroubleshooter.studentId + '&dateentered=' +
                                    powerTools.adaTroubleshooter.dateEntered, function(result){
                                powerTools.adaTroubleshooter.fteInfo = result;
                            }).done(function(){
                                powerTools.adaTroubleshooter.displayFte();
                            });
                        },
                        <!--Build Calendar and set it to current Month -->
                        buildCalendar: function(){
                            $j('#calendarData').empty();
                            var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                            var daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
                            var startDate = new Date(powerTools.adaTroubleshooter.currentDate.year,powerTools.adaTroubleshooter.currentDate.month-1, 1);
                            var inMonth = 0;
                            var outMonth = startDate.getDay() -1;
                            var day = getDaysInMonth(startDate.getMonth()-1)-outMonth;
                            $j('#calendarData').append(
                                  '<table class="grid" id="calendar" style="max-width:1200px"><th colspan="7" align=""center">' +
                                  months[powerTools.adaTroubleshooter.currentDate.month -1] + "     " + powerTools.adaTroubleshooter.currentDate.year + '</div></th><tbody>'+
                                  '<tr><td>Sun</td><td>Mon</td><td>Tues</td><td>Wed</td><td>Thurs</td><td>Fri</td><td>Sat</td>'
                            );
                            for(var i=0; i<6; i++){
                                $j('#calendar > tbody:last-child').append(
                                        '</tr><tr>'
                                );
                                for(var j=0;j<7;j++){
                                    if(inMonth == 0 && day > getDaysInMonth(startDate.getMonth()-1)){
                                        day = 1;
                                        inMonth = 1;
                                    }
                                    else if(inMonth == 1 && day > getDaysInMonth(startDate.getMonth())){
                                        day = 1;
                                        inMonth == 2;
                                    }
                                    if(inMonth == 1) {
                                        powerTools.adaTroubleshooter.daysObjects.push({day: day});
                                    }
                                    $j('#calendar > tbody:last-child').append(
                                            '<td class="square">' + day + '</td>'
                                    );
                                    day++;
                                }
                            }
                            $j('#calendarData > tbody:last-child').append(
                                  '</tr></tbody></table>'
                            );
                            function getDaysInMonth(month)
                            {
                                if(month == 1)
                                {
                                    if(powerTools.adaTroubleshooter.currentDate.year %4 == 0 && powerTools.adaTroubleshooter.currentDate.year % 100 != 0 ||
                                            powerTools.adaTroubleshooter.currentDate.year % 400 == 0) {
                                        return 29;
                                    }
                                }
                                else if(month == -1){
                                    return 31;
                                }
                                return daysInMonth[month];
                            }

                        },
                        /* Display Student Info */
                        displayStudent: function(){
                            $j('#studentData').append(
                                    '<table class="grid" id="studentTable"><th colspan="2" align="center">Student Information</th>'+
                                    '<tr><td>Entry Date:</td><td>' + powerTools.adaTroubleshooter.studentInfo.entrydate + '</td></tr>'+
                                    '<tr><td>Exit Date:</td><td>' + powerTools.adaTroubleshooter.studentInfo.exitdate + '</td></tr>'+
                                    '<tr><td>Membership Share:</td><td>' + powerTools.adaTroubleshooter.studentInfo.membershipshare + '</td></tr>'+
                                    '<tr><td>Track:</td><td>' + powerTools.adaTroubleshooter.studentInfo.track + '</td></tr>'+
                                    '</table>'
                            );
                        },
                        /* Display School Info */
                        displayFte: function(){
                            $j('#fteData').append(
                                    '<table class="grid" id="fteTable"><th colspan="2" align="center">FTE Information</th>'+
                                    '<tr><td>FTE Name:</td><td>' + powerTools.adaTroubleshooter.fteInfo.name + '</td></tr>'+
                                    '<tr><td>FTE Year ID:</td><td>' + powerTools.adaTroubleshooter.fteInfo.yearid + '</td></tr>'+
                                    '<tr><td>Attendance Mode:</td><td>' + powerTools.adaTroubleshooter.fteInfo.attmodecode + '</td></tr>'+
                                    '<tr><td>Attendance Conversion:</td><td>' + powerTools.adaTroubleshooter.fteInfo.conversionmodecode + '</td></tr>'+
                                    '</table>'
                            );
                        }
                    }
                };
        $j(document).ready(function(){
            var today = new Date();
            powerTools.adaTroubleshooter.currentDate.day = today.getDate();
            powerTools.adaTroubleshooter.currentDate.month = today.getMonth() +1;
            powerTools.adaTroubleshooter.currentDate.year = today.getFullYear();
            powerTools.adaTroubleshooter.retrieveStudent();
            powerTools.adaTroubleshooter.retrieveFte();
            powerTools.adaTroubleshooter.buildCalendar();
            $j('#dateSelector').on('change', function () {
                var selectedDate =[3];
                selectedDate = $j('#dateSelector').val().split("/");
                powerTools.adaTroubleshooter.currentDate.month = selectedDate[0];
                powerTools.adaTroubleshooter.currentDate.day = selectedDate[1];
                powerTools.adaTroubleshooter.currentDate.year = selectedDate[2];
                powerTools.adaTroubleshooter.buildCalendar();
            });
        });

    </script>
<style>
    .square {
        width: 14.28%;
        padding-bottom: 8.03%; /* = width for a 1:1 aspect ratio */
    }
</style>
</head>
<body>
~[wc:admin_header_frame_css]
<!-- breadcrumb start -->
<a href="/admin/home.html" target="_top">~[text:psx.html.admin_students.honorroll.start_page]</a>
&gt; <a href="home.html?selectstudent=nosearch" target="_top">~[text:psx.html.admin_students.honorroll.student_selection]</a>
&gt;~[text:psx.html.admin_students.honorroll.honor_roll1]
<!-- breadcrumb end -->
~[wc:admin_navigation_frame_css] ~[wc:title_student_begin_css]ADA Troubleshooter~[wc:title_student_end_css]
<!-- start of content and bounding box -->
<div class="box-round">
    <div id="dateSelection">
        <table class="linkDescList">
            <tb><p><b>This utility will help to determine how Average Daily Attendance and Membership are calculated, should the attendance views
               be updated. If the data your are displaying on this page does not match the ADA/ADM reports, try <a href="/admin/reports_engine/report_w_param.html?ac=reports_get_using_ID;repo_ID=ATT_RefreshPremierMembrDefaults">refreshing
               the Premier Attendance Views Data</a>.
            </b></p></tb>
        </table>
    </div>
    <div id="error"></div>
    <div id="studentData"></div>
    <div id="fteData"></div>
    <div id="dayInformation"></div>
        <table class="linkDescList"><th>Pick A Date<input id="dateSelector" type="text" class="psDateWidget" /></th></table>
    <div id="calendarData" align="center"></div>
    <div id="prevEnrollmentData"></div>
    <div id="calendarLegend"></div>
</div>
<!-- end of content of bounding box -->
~[wc:admin_footer_frame_css]
</body>
</html>
<!-- end right frame -->

